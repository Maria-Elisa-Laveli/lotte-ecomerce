<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro</title>
  <link rel="stylesheet" href="css/cadastro.css">
</head>
<body>
  <div class="box">
    <form id="formCadastro" autocomplete="off">
      <fieldset>
        <legend><b>Cadastre-se</b></legend>

        <div class="inputbox">
          <input type="text" name="nome" id="nome" class="inputuser" required>
          <label for="nome">Nome Completo</label>
        </div>

        <div class="inputbox">
          <input type="email" name="email" id="email" class="inputuser" required>
        
          <label for="email">E-mail</label>
        </div>

        <div class="inputbox">
          <input type="text" name="username" id="username" class="inputuser" required>
          <label for="username">Nome de Usuario</label>
        </div>

        <div class="inputbox">
          <input type="tel" name="telefone" id="telefone" class="inputuser" required>
          <label for="telefone">Telefone</label>
        </div>

        <div class="inputbox">
          <input type="password" name="senha" id="senha" class="inputuser" required>
          <label for="senha">Senha</label>
        </div>

        <p>Sexo:</p>
        <div class="radio-group">
          <input type="radio" name="sexo" id="feminino" value="feminino" required>
          <label for="feminino">Feminino</label>

          <input type="radio" name="sexo" id="masculino" value="masculino" required>
          <label for="masculino">Masculino</label>

          <input type="radio" name="sexo" id="outro" value="outro" required>
          <label for="outro">Outro</label>
        </div>

        <div class="inputbox">
          <input type="date" name="data" id="data" class="inputuser" required>
          <label for="data">Data de Nascimento</label>
        </div>

        <div class="inputbox">
          <input type="text" name="cidade" id="cidade" class="inputuser" required>
          <label for="cidade">Cidade</label>
        </div>

        <div class="inputbox">
          <input type="text" name="estado" id="estado" class="inputuser" required>
          <label for="estado">Estado</label>
        </div>

        <div class="inputbox">
          <input type="text" name="endereco" id="endereco" class="inputuser" required>
          <label for="endereco">Endere칞o</label>
        </div>

        <input type="submit" id="submit" value="Cadastrar">
      </fieldset>
    </form>
  </div>

  <script>
 const form = document.getElementById("formCadastro");

// Cria um elemento para mostrar mensagens
let mensagem = document.createElement("div");
mensagem.id = "mensagemCadastro";
mensagem.style.marginTop = "15px";
mensagem.style.fontWeight = "bold";
form.appendChild(mensagem);

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const dados = Object.fromEntries(new FormData(e.target));
  console.log("游닋 Enviando cadastro:", dados);

  try {
    const resposta = await fetch("http://localhost:3000/cadastro", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(dados)
    });

    const resultado = await resposta.json();
    console.log("游닌 Resposta do servidor:", resultado);

    if (resposta.ok) {
      // Mostra aviso de sucesso na p치gina
      mensagem.textContent = resultado.message || "Cadastro realizado com sucesso!";
      mensagem.style.color = "green";

      // Limpa o formul치rio
      form.reset();

      // Redireciona ap칩s 1,5s
      setTimeout(() => {
        window.location.href = "login.html";
      }, 1500);

    } else {
      // Mostra erro na p치gina
      mensagem.textContent = resultado.error || "Erro ao cadastrar usu치rio.";
      mensagem.style.color = "red";
    }

  } catch (err) {
    console.error("Erro no fetch:", err);
    mensagem.textContent = "Erro ao cadastrar usu치rio.";
    mensagem.style.color = "red";
  }
});


  </script>
</body>
</html>